<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagify SDK - Interactive Demo</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        .controls-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }

        .preview-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .preview-area {
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            min-height: 200px;
            padding: 15px;
            background: white;
            margin-bottom: 15px;
        }

        .iframe-container {
            width: 100%;
            min-height: 400px;
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            background: white;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .iframe-container iframe {
            width: 100%;
            height: 400px;
            border: none;
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .code-preview {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e1e5e9;
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: white;
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Pagify SDK Demo</h1>
            <p>Interactive demonstration of the Pagify SDK render API</p>
        </div>

        <div class="main-content">
            <!-- Controls Section -->
            <div class="controls-section">
                <h2>‚öôÔ∏è Configuration</h2>
                <form id="pagifyForm">
                    <!-- HTML Content -->
                    <div class="form-group">
                        <label for="bodyHtml">Body HTML Content:</label>
                        <textarea id="bodyHtml" rows="6" placeholder="Enter your HTML content here...">
<h1>Welcome to Pagify SDK</h1>
<p>This is a sample document that demonstrates the pagination capabilities of Pagify SDK.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
<div style="page-break-after: always;"></div>
<h2>Page 2 Content</h2>
<p>This content will appear on the second page due to the page break above.</p>
<p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.</p>
                        </textarea>
                    </div>

                    <div class="form-group">
                        <label for="headerHtml">Header HTML:</label>
                        <textarea id="headerHtml" rows="3" placeholder="Optional header content...">
<div style="text-align: center; font-weight: bold; color: #667eea;">
    Company Header - Pagify SDK Demo
</div>
                        </textarea>
                    </div>

                    <div class="form-group">
                        <label for="footerHtml">Footer HTML:</label>
                        <textarea id="footerHtml" rows="3" placeholder="Optional footer content...">
<div style="text-align: center; font-size: 12px; color: #666;">
    <span class="page-number"></span> | ¬© 2025 Pagify SDK Demo
</div>
                        </textarea>
                    </div>

                    <div class="form-group">
                        <label for="headHtml">Head HTML (CSS/Meta):</label>
                        <textarea id="headHtml" rows="3" placeholder="Optional head content...">
<style>
    body { font-family: Arial, sans-serif; }
    h1 { color: #667eea; }
    .page-number::before { content: "Page " counter(page) " of " counter(pages); }
</style>
                        </textarea>
                    </div>

                    <!-- Page Settings -->
                    <div class="form-group">
                        <label for="pageSize">Page Size:</label>
                        <select id="pageSize">
                            <option value="A4">A4</option>
                            <option value="A3">A3</option>
                            <option value="A5">A5</option>
                            <option value="Letter">Letter</option>
                            <option value="Legal">Legal</option>
                        </select>
                    </div>

                    <!-- Margins -->
                    <div class="form-group">
                        <label for="marginLeft">Left Margin:</label>
                        <input type="text" id="marginLeft" value="20mm" placeholder="e.g., 20mm, 1in, 50px">
                    </div>

                    <div class="form-group">
                        <label for="marginRight">Right Margin:</label>
                        <input type="text" id="marginRight" value="20mm" placeholder="e.g., 20mm, 1in, 50px">
                    </div>

                    <div class="form-group">
                        <label for="headerHeight">Header Height:</label>
                        <input type="text" id="headerHeight" value="30mm" placeholder="e.g., 30mm, 1in, 50px">
                    </div>

                    <div class="form-group">
                        <label for="footerHeight">Footer Height:</label>
                        <input type="text" id="footerHeight" value="20mm" placeholder="e.g., 20mm, 1in, 50px">
                    </div>

                    <div class="form-group">
                        <label for="pagePaddingTop">Page Padding Top:</label>
                        <input type="text" id="pagePaddingTop" value="16px" placeholder="e.g., 16px, 1em">
                    </div>

                    <!-- Page Number Settings -->
                    <div class="form-group">
                        <label for="pageNumberSelector">Page Number CSS Selector:</label>
                        <input type="text" id="pageNumberSelector" value=".page-number" placeholder="e.g., .page-number, #pageNum">
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="footerOnlyOnLastPage">
                            <label for="footerOnlyOnLastPage">Footer only on last page</label>
                        </div>
                    </div>

                    <!-- Container Settings -->
                    <div class="form-group">
                        <label for="containerSelector">Container Selector:</label>
                        <input type="text" id="containerSelector" value="#preview-container" placeholder="e.g., #myContainer, .preview">
                    </div>

                    <!-- Action Buttons -->
                    <button type="button" class="btn" onclick="renderPDF()">üìÑ Render PDF</button>
                    <button type="button" class="btn secondary" onclick="clearPreview()">üßπ Clear Preview</button>
                    <button type="button" class="btn secondary" onclick="loadSample()">üìù Load Sample</button>
                </form>
            </div>

            <!-- Preview Section -->
            <div class="preview-section">
                <h2>üëÅÔ∏è Preview & Output</h2>
                
                <!-- Status Display -->
                <div id="status" class="status info" style="display: none;">
                    Ready to render...
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="showTab('preview')">Live Preview</button>
                    <button class="tab" onclick="showTab('config')">Configuration JSON</button>
                    <button class="tab" onclick="showTab('console')">Console Log</button>
                </div>

                <!-- Tab Contents -->
                <div id="preview-tab" class="tab-content active">
                    <div class="iframe-container">
                        <div id="preview-container" style="text-align: center; padding: 50px; color: #666;">
                            Click "Render PDF" to see the paginated preview here
                        </div>
                    </div>
                </div>

                <div id="config-tab" class="tab-content">
                    <div class="code-preview" id="configPreview">
// Configuration will be shown here when you render
                    </div>
                </div>

                <div id="console-tab" class="tab-content">
                    <div class="code-preview" id="consoleLog">
// Console output will appear here
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Pagify SDK -->
    <script src="https://unpkg.com/@eka-care/pagify-sdk/dist/pagify.standalone.js"></script>
    
    <script>
        // Global variables
        let pagify = null;
        let consoleMessages = [];
        let isSDKReady = false;

        // Initialize Pagify SDK after DOM and script loading
        function initializePagifySDK() {
            try {
                // The UMD build exports the singleton instance as 'Pagify.default'
                if (window.Pagify && window.Pagify.default) {
                    pagify = window.Pagify.default;
                    console.log('‚úÖ Using Pagify.default singleton instance');
                } else if (window.Pagify && typeof window.Pagify.render === 'function') {
                    // Fallback: sometimes it might be directly on Pagify
                    pagify = window.Pagify;
                    console.log('‚úÖ Using Pagify direct instance');
                } else {
                    throw new Error('Pagify SDK not found. Expected window.Pagify.default');
                }
                
                // Verify the instance has the render method
                if (typeof pagify.render !== 'function') {
                    throw new Error('Pagify instance does not have render method');
                }
                
                isSDKReady = true;
                console.log('‚úÖ Pagify SDK initialized successfully');
                console.log('SDK instance type:', typeof pagify);
                console.log('Available methods:', Object.keys(pagify));
                updateStatus('Pagify SDK loaded and ready!', 'success');
                return true;
            } catch (error) {
                console.error('‚ùå Failed to initialize Pagify SDK:', error);
                updateStatus(`SDK initialization failed: ${error.message}`, 'error');
                return false;
            }
        }

        // Override console methods to capture output
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn,
            info: console.info
        };

        function logToConsole(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)).join(' ');
            consoleMessages.push(`[${timestamp}] [${type.toUpperCase()}] ${message}`);
            
            // Update console tab
            const consoleElement = document.getElementById('consoleLog');
            if (consoleElement) {
                consoleElement.textContent = consoleMessages.join('\n');
            }
            
            // Call original console method
            originalConsole[type](...args);
        }

        console.log = (...args) => logToConsole('log', ...args);
        console.error = (...args) => logToConsole('error', ...args);
        console.warn = (...args) => logToConsole('warn', ...args);
        console.info = (...args) => logToConsole('info', ...args);

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function getFormData() {
            return {
                body_html: document.getElementById('bodyHtml').value.trim(),
                header_html: document.getElementById('headerHtml').value.trim(),
                footer_html: document.getElementById('footerHtml').value.trim(),
                head_html: document.getElementById('headHtml').value.trim(),
                page_size: document.getElementById('pageSize').value,
                margin_left: document.getElementById('marginLeft').value,
                margin_right: document.getElementById('marginRight').value,
                header_height: document.getElementById('headerHeight').value,
                footer_height: document.getElementById('footerHeight').value,
                page_padding_top: document.getElementById('pagePaddingTop').value,
                page_number_selector: document.getElementById('pageNumberSelector').value,
                footer_only_on_last_page: document.getElementById('footerOnlyOnLastPage').checked,
                containerSelector: document.getElementById('containerSelector').value || null
            };
        }

        function updateStatus(message, type = 'info') {
            const statusElement = document.getElementById('status');
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
            statusElement.style.display = 'block';
            
            console.info('Status:', message);
        }

        function updateConfigPreview() {
            const config = getFormData();
            const configElement = document.getElementById('configPreview');
            configElement.textContent = `// Pagify SDK Configuration
const config = ${JSON.stringify(config, null, 2)};

// Render call
pagify.render({
    ...config,
    callback: () => {
        console.log('Pagination complete!');
    },
    onPdfReady: (blobUrl) => {
        console.log('PDF ready:', blobUrl);
        // Download or display PDF
    },
    onPdfError: (error) => {
        console.error('PDF generation error:', error);
    }
});`;
        }

        async function renderPDF() {
            try {
                // Check if SDK is ready
                if (!isSDKReady || !pagify) {
                    updateStatus('Initializing Pagify SDK...', 'info');
                    const initialized = initializePagifySDK();
                    if (!initialized) {
                        throw new Error('Failed to initialize Pagify SDK');
                    }
                }
                
                updateStatus('Preparing to render...', 'info');
                
                const config = getFormData();
                updateConfigPreview();
                
                // Clear previous content
                const container = document.querySelector(config.containerSelector || '#preview-container');
                if (container) {
                    container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Rendering...</div>';
                }
                
                console.log('Starting PDF render with config:', config);
                updateStatus('Rendering PDF with Pagify SDK...', 'info');
                
                // Call Pagify render
                await pagify.render({
                    ...config,
                    callback: () => {
                        console.log('‚úÖ Pagination completed successfully!');
                        updateStatus('Pagination completed! Check the preview above.', 'success');
                    },
                    onPdfReady: (blobUrl) => {
                        console.log('‚úÖ PDF ready! Blob URL:', blobUrl);
                        updateStatus('PDF generated successfully! Check console for blob URL.', 'success');
                        
                        // Create download link
                        const downloadLink = document.createElement('a');
                        downloadLink.href = blobUrl;
                        downloadLink.download = 'pagify-demo.pdf';
                        downloadLink.textContent = 'üì• Download PDF';
                        downloadLink.style.cssText = 'display: inline-block; margin-top: 10px; padding: 8px 16px; background: #28a745; color: white; text-decoration: none; border-radius: 4px;';
                        
                        const statusElement = document.getElementById('status');
                        statusElement.appendChild(document.createElement('br'));
                        statusElement.appendChild(downloadLink);
                    },
                    onPdfError: (error) => {
                        console.error('‚ùå PDF generation error:', error);
                        updateStatus(`PDF generation failed: ${error}`, 'error');
                    }
                });
                
            } catch (error) {
                console.error('‚ùå Render error:', error);
                updateStatus(`Render failed: ${error.message}`, 'error');
            }
        }

        function clearPreview() {
            const container = document.querySelector('#preview-container');
            if (container) {
                container.innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">Click "Render PDF" to see the paginated preview here</div>';
            }
            
            document.getElementById('status').style.display = 'none';
            consoleMessages = [];
            document.getElementById('consoleLog').textContent = '// Console output will appear here';
            
            console.log('üßπ Preview cleared');
        }

        function loadSample() {
            // Load sample data with more interesting content
            document.getElementById('bodyHtml').value = `<div style="padding: 20px;">
    <h1 style="color: #667eea; text-align: center;">Annual Report 2025</h1>
    
    <section>
        <h2>Executive Summary</h2>
        <p>This annual report demonstrates the powerful pagination capabilities of Pagify SDK. The document automatically flows across multiple pages while maintaining proper formatting and styling.</p>
        
        <div style="background: #f8f9fa; padding: 15px; border-left: 4px solid #667eea; margin: 20px 0;">
            <strong>Key Highlights:</strong>
            <ul>
                <li>üìà Revenue growth of 150%</li>
                <li>üöÄ New product launches</li>
                <li>üåç Global expansion</li>
                <li>üí° Innovation in PDF generation</li>
            </ul>
        </div>
    </section>
    
    <div style="page-break-after: always;"></div>
    
    <section>
        <h2>Financial Overview</h2>
        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <thead>
                <tr style="background: #667eea; color: white;">
                    <th style="padding: 10px; border: 1px solid #ddd;">Quarter</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">Revenue</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">Growth</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Q1 2025</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">$1.2M</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">+25%</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td style="padding: 10px; border: 1px solid #ddd;">Q2 2025</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">$1.5M</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">+30%</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Q3 2025</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">$1.8M</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">+35%</td>
                </tr>
            </tbody>
        </table>
    </section>
    
    <div style="page-break-after: always;"></div>
    
    <section>
        <h2>Future Outlook</h2>
        <p>Looking ahead to 2026, we anticipate continued growth driven by:</p>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                <h3 style="margin-top: 0; color: #1976d2;">Technology</h3>
                <p>Advanced PDF rendering with improved performance and new features.</p>
            </div>
            <div style="background: #f3e5f5; padding: 15px; border-radius: 8px;">
                <h3 style="margin-top: 0; color: #7b1fa2;">Market Expansion</h3>
                <p>Reaching new markets and customer segments worldwide.</p>
            </div>
        </div>
        
        <p style="text-align: center; font-style: italic; margin-top: 40px;">
            "Innovation in document generation is our passion" - Pagify Team
        </p>
    </section>
</div>`;

            document.getElementById('headerHtml').value = `<div style="text-align: center; font-weight: bold; color: #667eea; padding: 10px; border-bottom: 2px solid #667eea;">
    üìä Annual Report 2025 | Pagify SDK Demo
</div>`;

            document.getElementById('footerHtml').value = `<div style="text-align: center; font-size: 12px; color: #666; padding: 10px; border-top: 1px solid #ddd;">
    <span class="page-number"></span> | Confidential | ¬© 2025 Pagify SDK
</div>`;

            document.getElementById('headHtml').value = `<style>
    body { 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        line-height: 1.6; 
        color: #333;
    }
    h1, h2, h3 { 
        color: #667eea; 
        margin-bottom: 15px;
    }
    h1 { font-size: 2.5em; }
    h2 { font-size: 1.8em; border-bottom: 2px solid #667eea; padding-bottom: 5px; }
    h3 { font-size: 1.3em; }
    .page-number::before { 
        content: "Page " counter(page) " of " counter(pages); 
    }
    section {
        margin-bottom: 30px;
    }
    @media print {
        body { margin: 0; }
    }
</style>`;

            updateStatus('Sample content loaded! Click "Render PDF" to see the result.', 'info');
            console.log('üìù Sample content loaded');
        }

        // Initialize with config preview
        document.addEventListener('DOMContentLoaded', function() {
            updateConfigPreview();
            
            // Try to initialize SDK immediately
            setTimeout(() => {
                const initialized = initializePagifySDK();
                if (!initialized) {
                    updateStatus('SDK initialization failed. Please check the console.', 'error');
                }
            }, 100);
            
            console.log('üöÄ Pagify SDK Demo page loaded');
        });

        // Also try to initialize when window loads (fallback)
        window.addEventListener('load', function() {
            if (!isSDKReady) {
                console.log('Retrying SDK initialization on window load...');
                initializePagifySDK();
            }
        });

        // Update config preview when form changes
        document.getElementById('pagifyForm').addEventListener('input', updateConfigPreview);
        document.getElementById('pagifyForm').addEventListener('change', updateConfigPreview);
    </script>
</body>
</html>
